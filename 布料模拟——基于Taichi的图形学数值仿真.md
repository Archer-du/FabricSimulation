# 质点弹簧系统布料模拟

# ——基于Taichi的图形学数值仿真

---

==PB21050988杜朋澈==

## INDEX

[TOC]

## 背景简介

### 布料模拟

布料模拟是计算机图形学中的一个重要研究领域，它旨在用数学和物理模型来模拟现实中布料的运动和形变。布料模拟有很多应用场景，例如游戏设计、服装设计、虚拟人物设计、电影特效等。

布料模拟的基本原理可以分为以下几个方面：

- **布料结构的建立**：这一步是将现实中的布料用一些简化的数据结构来表示，通常是用一个二维网格来表示布料的表面，网格上的每个顶点都是一个质点，质点之间用弹簧来连接，表示布料的内部力。不同方向和距离的弹簧可以表示不同的物理特性，例如拉伸、弯曲、剪切等。
- **牛顿运动定律的应用**：这一步是根据牛顿力学的基本定律，计算每个质点受到的合力，从而得到每个质点的加速度、速度和位置。合力包括外力和内力，外力可以是重力、风力、摩擦力等，内力则是由弹簧产生的恢复力。为了计算每个质点的位置，需要用一些数值积分方法，例如欧拉法、Verlet法等。
- **布料与碰撞体的碰撞**：这一步是检测并处理布料与其他物体（例如胶囊体、球体等）或者自身（例如折叠、缠绕等）之间的碰撞。碰撞检测可以用一些简单的几何判断或者连续碰撞检测方法来实现。碰撞响应则是根据碰撞法向量和反弹系数来调整质点的位置和速度，使得布料不会穿透或者卡住其他物体。

## 理论基础

### 数值积分

数值积分是用于求定积分的近似值的一种方法。在数学分析中，有很多计算给定函数的定积分是不可行的，而数值积分是利用黎曼积分等数学定义，用数值逼近的方法近似计算给定的定积分值。借助计算机和编程，数值积分可以快速而有效地计算复杂的积分。

#### 欧拉方法

欧拉方法是一种数值积分方法，又称为欧拉折线法，是用折线来逼近曲线的一种方法。

例如可以转化为，其中h则为折线的步长。

由泰勒公式，可以看出欧拉公式实际上是泰勒公式的离散形式。很显然，h越小，欧拉方法的结果越精确，h越大，结果越不精确。

### 质点弹簧系统

- 质点弹簧系统是一种常用的布料模拟方法，它将布料的表面用一个二维网格来表示，网格上的每个顶点都是一个质点，质点之间用弹簧来连接，表示布料的内部力。
- 质点弹簧系统可以模拟布料的运动和形变，根据牛顿运动定律，计算每个质点受到的合力，从而得到每个质点的加速度、速度和位置。合力包括外力和内力，外力可以是重力、风力、摩擦力等，内力则是由弹簧产生的恢复力。
- 质点弹簧系统可以分为三种类型：结构弹簧、剪切弹簧和弯曲弹簧。结构弹簧的作用是为了保持质点之间的初始距离，用于防止在经纬二个方向有过度变形；剪切弹簧是为了模拟织物倾斜方向的作用力；弯曲弹簧是为了避免织物发生过度翻折。
- 质点弹簧系统可以用一些数值积分方法来求解，例如欧拉法、Verlet法等。也可以用一些隐式积分方法来提高稳定性和效率，例如牛顿法、投影动力学法等。
- 质点弹簧系统可以检测并处理布料与其他物体或者自身之间的碰撞，碰撞检测可以用一些简单的几何判断或者连续碰撞检测方法来实现。碰撞响应则是根据碰撞法向量和反弹系数来调整质点的位置和速度，使得布料不会穿透或者卡住其他物体。

质点弹簧系统中，一般只考虑相邻的质点之间存在弹簧，或者隔一个质点的邻接质点之间存在弹簧。这样可以减少计算量和复杂度，也可以保持布料的基本特性。如果任意两个质点之间都视为存在一个弹簧，那么布料会变得非常僵硬和不自然。

####受力分析

- **弹簧弹力**

  由胡克定律，易得$\vec{x_b}$处质点对$\vec{x_a}$处的质点的弹力为：

$$
f(x_a)_{s} = -k_s \frac{\vec{x_a}-\vec{x_b}}{|\vec{x_a}-\vec{x_b}|}(|\vec{x_a}-\vec{x_b}|-l)
$$

- **弹簧阻尼**

  

$$
f(x_a)_{d} = -k_d \frac{\vec{x_a}-\vec{x_b}}{|\vec{x_a}-\vec{x_b}|}(\vec{v_a} - \vec{v_b})· \frac{\vec{x_a}-\vec{x_b}}{|\vec{x_a}-\vec{x_b}|}
$$

- **空气阻力**

  不论是什么方法、几阶精度，都会有相应的误差，而误差的累计可以导致整个系统崩溃。空气阻尼可以在一定程度上缓解这一点：对每个质点在其速度相反方向施加一个微小的空气阻力，一般情况下空气阻力均与速度成反比:

  $$
  f_{air}(x_a) = -k|\vec{v_a}|^2·\frac{\vec{v_a}}{|\vec{v_a}|}
  $$
